---
import type { StrapiImageType } from "@/types/common";
import { buildStrapiResponsive } from "@/utils/strapiImg";
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import SecondaryCTA from "@components/ui/buttons/SecondaryCTA.astro";
import { Image } from "astro:assets";

const {
  title,
  subtitle,
  primaryBtnLabel,
  primaryBtnURL,
  secondaryBtnLabel,
  secondaryBtnURL,
  img,
  imgAlt,
  customWrapperStyle,
} = Astro.props;

export interface AboutSectionProps {
  title: string;
  subtitle?: string;
  primaryBtnLabel?: string;
  primaryBtnURL?: string;
  secondaryBtnLabel?: string;
  secondaryBtnURL?: string;
  img?: StrapiImageType;
  imgAlt?: string | null;
  customWrapperStyle?: string;
}

interface Props extends AboutSectionProps {}

let builtImg = null;

if (img) {
  builtImg = buildStrapiResponsive(img);
}

const customWrapperStyleStr = customWrapperStyle ? customWrapperStyle : "";
---

<section
  class="header-text-dark mx-auto flex flex-col gap-6 bg-[#F5F5F5] px-4 py-[100px] pb-[142px] md:items-center md:gap-8 md:py-[120px] md:pb-[120px] lg:px-10"
  style={customWrapperStyleStr}
>
  <div data-aos="fade-up" data-aos-delay="150" data-aos-once="true" class="w-full">
    <div class="mx-auto w-full max-w-7xl">
      <h1
        class="text-text-main font-helvetica-black block text-center text-[32px] leading-[120%] font-bold text-balance whitespace-pre-line lg:text-[52px] dark:text-neutral-200"
      >
        <Fragment set:html={title} />
      </h1>
      {
        subtitle && (
          <p class="text-text-secondary mx-auto mt-6 w-full max-w-[846px] text-center text-lg text-pretty">
            {subtitle}
          </p>
        )
      }
      {
        (primaryBtnLabel || secondaryBtnLabel) && (
          <div class="mt-6 grid w-full justify-center gap-3 sm:inline-flex">
            {primaryBtnLabel && (
              <PrimaryCTA title={primaryBtnLabel} url={primaryBtnURL} noArrow className="w-[300px] h-[46px]" />
            )}
            {secondaryBtnLabel && (
              <SecondaryCTA
                title={secondaryBtnLabel}
                url={secondaryBtnURL}
                className="w-48 h-[46px] text-primary"
                arrow
              />
            )}
          </div>
        )
      }

      {
        builtImg && (
          <Image
            src={builtImg.src}
            width={builtImg.width}
            height={builtImg.height}
            srcset={builtImg.srcset}
            sizes="(max-width: 500px) 500px, 100vw"
            alt={builtImg.alt ?? imgAlt ?? "background image"}
            draggable={"false"}
            loading={"eager"}
            fetchpriority={"high"}
            class="m-auto mt-[46px] h-full max-h-[570px] w-full max-w-7xl overflow-hidden rounded-2xl object-cover object-center"
          />
        )
      }
    </div>
  </div>
</section>
